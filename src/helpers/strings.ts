import lodash from 'lodash'
import format from 'string-template'
import { GREEN_MARK, RED_CROSS } from '../const/emojies'

type TemplateProcessor = (values?: { [key: string]: string }) => string
type InstrumentedStringTree<T> = {
  [P in keyof T]: T[P] extends string ? TemplateProcessor : InstrumentedStringTree<T[P]>
}

type StringTree = {
  [key: string]: string | StringTree
}

function instrumentWithVars<T extends StringTree>(src: T) {
  let result = {}

  for (let key of Object.keys(src)) {
    const source = src[key]

    if (typeof source === 'string') {
      result[key] = (data?: { [key: string]: string }) => {
        if (key.endsWith('__html')) {
          data = lodash.mapValues(data, (val) => lodash.escape(val))
        }

        return format(source || key, data)
      }
    } else {
      result[key] = instrumentWithVars(source)
    }
  }

  return result as InstrumentedStringTree<T>
}

const strings = {
  user: {
    greet: '–ü—Ä–∏–≤–µ—Ç! –Ø –±–æ—Ç –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–∞ –ß–µ–º–ø–∏–æ–Ω–∞—Ç –†–æ—Å—Å–∏–∏ –ø–æ –≤–æ–ª–µ–π–±–æ–ª—É.',
    btns: {
      info: '–ß—Ç–æ –Ω–∞–¥–æ –±—É–¥–µ—Ç –¥–µ–ª–∞—Ç—å?',
      register: '–•–æ—á—É –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è',
    },
  },
  admin: {
    greet: '–ö–æ–º–∞–Ω–¥—ã –∫–æ—Ç–æ—Ä—ã–µ —è —É–º–µ—é –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å:' + '\n/add ‚Äï –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é',
    // '\n/edit ‚Äï –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π',
    btns: {
      info: '–ß—Ç–æ –Ω–∞–¥–æ –±—É–¥–µ—Ç –¥–µ–ª–∞—Ç—å?',
      create: '–°–æ–∑–¥–∞—Ç—å –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ',
    },
  },
  system: {
    accessDenied: '–Ø –Ω–µ –∑–Ω–∞—é —Ç–∞–∫—É—é –∫–æ–º–∞–Ω–¥—É...',
  },
  main: {
    admin: `–ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—ã.
        
/cancel - –≤—Å–µ–≥–¥–∞ –≤–µ—Ä–Ω—ë—Ç –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é`,
    user: `–¢–≤–æ—è –∫–æ–º–∞–Ω–¥–∞ - {team}
–¢—ã –º–æ–∂–µ—à—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –Ω–æ–≤—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã, –∏–ª–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç–∞—Ä—ã–µ.

/cancel - –≤—Å–µ–≥–¥–∞ –≤–µ—Ä–Ω—ë—Ç –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é`,
    btns: {
      addTeam: '–°–æ–∑–¥–∞—Ç—å –∫–æ–º–∞–Ω–¥—É',
      gdriveHealthcheck: '–°–æ—Å—Ç–æ—è–Ω–∏–µ GDrive',
      uploadDocuments: '–ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç',
      uploadedFiles: '–ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã',
    },
  },
  approve: {
    approveText__html: '–ü—Ä–∏–Ω–∏–º–∞–µ–º <b>{user}</b>?',
    resolution: {
      approved__html: `{user} ${GREEN_MARK} {date}`,
      denied__html: `{user} ${RED_CROSS}`,
    },
    approveBtn: `–î–∞ ${GREEN_MARK}`,
    denyBtn: `–ù–µ—Ç ${RED_CROSS}`,
    notice: {
      approved: `–ó–∞—è–≤–∫–∞ –Ω–∞ {date} –±—ã–ª–∞ –ø—Ä–∏–Ω—è—Ç–∞! ${GREEN_MARK}`,
      denied: `–ó–∞—è–≤–∫–∞ –Ω–∞ {date} –±—ã–ª–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞ ${RED_CROSS}`,
    },
  },
  common: {
    confirm: {
      text: '–î–∞–Ω–Ω—ã–µ –≤–µ—Ä–Ω—ã?',
      yes: '–î–∞, –¥–∞–Ω–Ω—ã–µ –≤–µ—Ä–Ω—ã',
      no: '–ù–µ—Ç, –¥–∞–≤–∞–π –ø–æ-–Ω–æ–≤–æ–π',
      restart: '–ü–æ-–Ω–æ–≤–æ–π —Ç–∞–∫ –ø–æ-–Ω–æ–≤–æ–π...',
    },
    backBtn: 'üîô –ù–∞–∑–∞–¥',
  },
  register: {
    choseEvent: '–í—ã–±–µ—Ä–∏ –Ω–∞ –∫–∞–∫–æ–µ –∑–∞–ø–∏—Å—ã–≤–∞–µ—à—å—Å—è?',
    choseEventChosen: '–í—ã–±–µ—Ä–∏ –Ω–∞ –∫–∞–∫–æ–µ –∑–∞–ø–∏—Å—ã–≤–∞–µ—à—å—Å—è?\n{event}\n\n{description}',
    enterName: '–í–≤–µ–¥–∏ —Å–≤–æ—ë –∏–º—è',
    enterMidname: '–í–≤–µ–¥–∏ —Å–≤–æ—ë –æ—Ç—á–µ—Å—Ç–≤–æ',
    enterSurname: '–í–≤–µ–¥–∏ —Å–≤–æ—é —Ñ–∞–º–∏–ª–∏—é',
    // TODO –Ω–∞–¥–æ –±–æ–ª–µ–µ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫—É
    enterGroup__html: '–£–∫–∞–∂–∏ –∏–Ω–¥–µ–∫—Å —Å–≤–æ–µ–π –≥—Ä—É–ø–ø—ã (–ø—Ä–∏–º–µ—Ä: <code>–ò–£7-11–ë</code>)',
    enterVaccine: '–ü—Ä–∏–ª–æ–∂–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –æ –≤–∞–∫—Ü–∏–Ω–∞—Ü–∏–∏',
    final: '–ó–∞—è–≤–∫–∞ –ø—Ä–∏–Ω—è—Ç–∞ –Ω–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ. –Ø –Ω–∞–ø–∏—à—É, –µ—Å–ª–∏ –æ–Ω–∞ –±—É–¥–µ—Ç –ø—Ä–∏–Ω—è—Ç–∞ –∏–ª–∏ –µ—Å–ª–∏ –±—É–¥—É—Ç –ø—Ä–æ–±–ª–µ–º—ã.',
  },
  eventCreate: {
    enterDate: '–í–≤–µ–¥–∏—Ç–µ –¥–∞—Ç—É',
    enterTimeSpan__html: '–í–≤–µ–¥–∏—Ç–µ –ø—Ä–æ–º–µ–∂—É—Ç–æ–∫ –≤—Ä–µ–º–µ–Ω–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ <code>{format}</code>',
    wrongFormat__html: '–ù–µ –º–æ–≥—É –ø–æ–Ω—è—Ç—å, —á—Ç–æ —ç—Ç–æ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑ —Å —Å–æ–±–ª—é–¥–µ–Ω–∏–µ–º —Ñ–æ—Ä–º–∞—Ç–∞ <code>{format}</code>',
    enterDescription: '–í–≤–µ–¥–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ. –û–Ω–æ –±—É–¥–µ—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏',
    final: '–ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ –∏ –Ω–∞ –Ω–µ–≥–æ —Ç–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è.',
  },
  eventEdit: {
    choseEvent: '–†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ?',
    choseEventChosen: '–†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ\n{event}',
    enterDate: '–í–≤–µ–¥–∏—Ç–µ –¥–∞—Ç—É. –í–≤–µ–¥–∏—Ç–µ, + —á—Ç–æ–±—ã –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–µ–∫—É—â–µ–µ. –¢–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ:',
    enterTimeSpan: '–í–≤–µ–¥–∏—Ç–µ –ø—Ä–æ–º–µ–∂—É—Ç–æ–∫ –≤—Ä–µ–º–µ–Ω–∏. –í–≤–µ–¥–∏—Ç–µ, + —á—Ç–æ–±—ã –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–µ–∫—É—â–µ–µ. –¢–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ:',
    wrongFormat__html: '–ù–µ –º–æ–≥—É –ø–æ–Ω—è—Ç—å, —á—Ç–æ —ç—Ç–æ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑ —Å —Å–æ–±–ª—é–¥–µ–Ω–∏–µ–º —Ñ–æ—Ä–º–∞—Ç–∞ <code>{format}</code>',
    enterDescription: '–í–≤–µ–¥–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ. –í–≤–µ–¥–∏—Ç–µ, + —á—Ç–æ–±—ã –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–µ–∫—É—â–µ–µ. –¢–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ–ñ',
    choseStatus: '–í—ã–±–µ—Ä–∏—Ç–µ –æ—Ç–∫—Ä—ã—Ç–æ—Å—Ç—å',
    choseStatusChosen: '–í—ã–±—Ä–∞–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:\n{status}',
    final: '–ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ.'
  },
  errors: {
    notText: '–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, —è –Ω–µ –ø–æ–Ω–∏–º–∞—é. –í–≤–µ–¥–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–º'
  }
}

export default instrumentWithVars(strings)
